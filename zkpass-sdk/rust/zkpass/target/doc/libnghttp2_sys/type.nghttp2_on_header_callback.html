<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="@functypedef"><title>nghttp2_on_header_callback in libnghttp2_sys - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="libnghttp2_sys" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0 (cc66ad468 2023-10-03)" data-channel="1.73.0" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-1596385f77d47ef2.css" data-theme-dark-css="dark-0a43001d3fc2282c.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-1596385f77d47ef2.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-0a43001d3fc2282c.css"><link rel="stylesheet" href="../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc type"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../libnghttp2_sys/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../libnghttp2_sys/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">nghttp2_on_header_callback</a></h2><div class="sidebar-elems"><h2><a href="index.html">In libnghttp2_sys</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Type Definition <a href="index.html">libnghttp2_sys</a>::<wbr><a class="type" href="#">nghttp2_on_header_callback</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/libnghttp2_sys/lib.rs.html#1158-1169">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub type nghttp2_on_header_callback = <a class="enum" href="https://doc.rust-lang.org/1.73.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;unsafe extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.fn.html">fn</a>(session: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.pointer.html">*mut </a><a class="struct" href="struct.nghttp2_session.html" title="struct libnghttp2_sys::nghttp2_session">nghttp2_session</a>, frame: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.pointer.html">*const </a><a class="union" href="union.nghttp2_frame.html" title="union libnghttp2_sys::nghttp2_frame">nghttp2_frame</a>, name: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>, namelen: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>, value: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>, valuelen: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>, flags: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>, user_data: <a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.pointer.html">*mut </a><a class="type" href="https://doc.rust-lang.org/1.73.0/std/os/raw/type.c_void.html" title="type std::os::raw::c_void">c_void</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/os/raw/type.c_int.html" title="type std::os::raw::c_int">c_int</a>&gt;;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>@functypedef</p>
<p>Callback function invoked when a header name/value pair is received
for the |frame|.  The |name| of length |namelen| is header name.
The |value| of length |valuelen| is header value.  The |flags| is
bitwise OR of one or more of :type:<code>nghttp2_nv_flag</code>.</p>
<p>If :enum:<code>NGHTTP2_NV_FLAG_NO_INDEX</code> is set in |flags|, the receiver
must not index this name/value pair when forwarding it to the next
hop.  More specifically, “Literal Header Field never Indexed”
representation must be used in HPACK encoding.</p>
<p>When this callback is invoked, <code>frame-&gt;hd.type</code> is either
:enum:<code>NGHTTP2_HEADERS</code> or :enum:<code>NGHTTP2_PUSH_PROMISE</code>.  After all
header name/value pairs are processed with this callback, and no
error has been detected, :type:<code>nghttp2_on_frame_recv_callback</code>
will be invoked.  If there is an error in decompression,
:type:<code>nghttp2_on_frame_recv_callback</code> for the |frame| will not be
invoked.</p>
<p>Both |name| and |value| are guaranteed to be NULL-terminated.  The
|namelen| and |valuelen| do not include terminal NULL.  If
<code>nghttp2_option_set_no_http_messaging()</code> is used with nonzero
value, NULL character may be included in |name| or |value| before
terminating NULL.</p>
<p>Please note that unless <code>nghttp2_option_set_no_http_messaging()</code> is
used, nghttp2 library does perform validation against the |name|
and the |value| using <code>nghttp2_check_header_name()</code> and
<code>nghttp2_check_header_value()</code>.  In addition to this, nghttp2
performs validation based on HTTP Messaging rule, which is briefly
explained in :ref:<code>http-messaging</code> section.</p>
<p>If the application uses <code>nghttp2_session_mem_recv()</code>, it can return
:enum:<code>NGHTTP2_ERR_PAUSE</code> to make <code>nghttp2_session_mem_recv()</code>
return without processing further input bytes.  The memory pointed
by |frame|, |name| and |value| parameters are retained until
<code>nghttp2_session_mem_recv()</code> or <code>nghttp2_session_recv()</code> is called.
The application must retain the input bytes which was used to
produce these parameters, because it may refer to the memory region
included in the input bytes.</p>
<p>Returning :enum:<code>NGHTTP2_ERR_TEMPORAL_CALLBACK_FAILURE</code> will close
the stream (promised stream if frame is PUSH_PROMISE) by issuing
RST_STREAM with :enum:<code>NGHTTP2_INTERNAL_ERROR</code>.  In this case,
:type:<code>nghttp2_on_header_callback</code> and
:type:<code>nghttp2_on_frame_recv_callback</code> will not be invoked.  If a
different error code is desirable, use
<code>nghttp2_submit_rst_stream()</code> with a desired error code and then
return :enum:<code>NGHTTP2_ERR_TEMPORAL_CALLBACK_FAILURE</code>.  Again, use
<code>frame-&gt;push_promise.promised_stream_id</code> as stream_id parameter
in <code>nghttp2_submit_rst_stream()</code> if frame is PUSH_PROMISE.</p>
<p>The implementation of this function must return 0 if it succeeds.
It may return :enum:<code>NGHTTP2_ERR_PAUSE</code> or
:enum:<code>NGHTTP2_ERR_TEMPORAL_CALLBACK_FAILURE</code>.  For other critical
failures, it must return :enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code>.  If
the other nonzero value is returned, it is treated as
:enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code>.  If
:enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code> is returned,
<code>nghttp2_session_recv()</code> and <code>nghttp2_session_mem_recv()</code> functions
immediately return :enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code>.</p>
<p>To set this callback to :type:<code>nghttp2_session_callbacks</code>, use
<code>nghttp2_session_callbacks_set_on_header_callback()</code>.</p>
<p>.. warning::</p>
<p>Application should properly limit the total buffer size to store
incoming header fields.  Without it, peer may send large number
of header fields or large header fields to cause out of memory in
local endpoint.  Due to how HPACK works, peer can do this
effectively without using much memory on their own.</p>
</div></details></section></div></main></body></html>